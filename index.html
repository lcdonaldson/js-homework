<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Household builder</title>
        <style>
            .debug {
                font-family: monospace;
                border: 1px solid black;
                padding: 10px;
                display: none;
            }
        </style>
    </head>

    <body>
        <h1>Household builder</h1>
        <div class="builder">
            <ol class="household"></ol>
            <form>
                <div>
                    <label>Age
                        <input type="text" name="age">
                    </label>
                </div>
                <div>
                    <label>Relationship
                        <select name="rel">
                            <option value="">---</option>
                            <option value="self">Self</option>
                            <option value="spouse">Spouse</option>
                            <option value="child">Child</option>
                            <option value="parent">Parent</option>
                            <option value="grandparent">Grandparent</option>
                            <option value="other">Other</option>
                        </select>
                    </label>
                </div>
                <div>
                    <label>Smoker?
                        <input type="checkbox" name="smoker">
                    </label>
                </div>
                <div>
                    <button class="add">add</button>
                </div>
                <div>
                    <button type="submit">submit</button>
                </div>
            </form>
        </div>
        <pre class="debug"></pre>
        <script>
            //initialize the DOM, and have default UI created
            function start() {

            // required fields info
                var info = document.createElement('div');
                info.id = 'panel';
                info.className = 'req_info';

                document.getElementsByTagName('body')[0].appendChild(info);
                info.style.cssText = 'margin:5px 0;';

                var required = document.createElement('p');
                required.style.cssText = 'color:blue;';
                
                var textnode = document.createTextNode('* Fields in blue are required');
                required.appendChild(textnode);
                info.appendChild(required);

            // age field
                var age = document.getElementsByName('age')[0];
                age.style.cssText = 'border:1px solid blue;margin:5px;';

            // relationship field
                var rel_id = document.getElementsByTagName('select')[0];
                rel_id.setAttribute('id', 'options');
                rel_id.style.cssText = 'border:1px solid blue;margin:5px;';

            // smoker field
                var smoker = document.getElementsByTagName('input')[1];
                smoker.setAttribute('id', 'smoker');
                smoker.type = "checkbox";
                smoker.value = "yes";

            // create div panel to append list itmes    
                var div = document.getElementsByTagName("ol")[0];
                div.setAttribute('id', 'list');
                div.style.cssText = 'position:absolute;padding:10px;margin:10px 2px;width:50%;min-height:50px;max-height:80px;z-index:100;background-color:#C7C7C7;color:#666;';
                document.getElementsByTagName('body')[0].appendChild(div);
                var helptext = document.createTextNode('Your input will be displayed here');
                div.appendChild(helptext);

                var visible = document.getElementsByTagName("pre")[0];
                visible.style.cssText = "display:block;position:relative;top:120px;right:0;";
                document.getElementById('list').after(visible);

            };
            window.onload = start;

            document.getElementsByClassName('add')[0].addEventListener('click', addPerson);

            function addPerson(e) {
            
            // age field - grab value and validate
                var age = document.getElementsByName('age')[0];
                var age_val = age.value
                if(isNaN(age_val)) {
                    alert("Please use numbers only");
                    return false
                } else if (age_val.length == 0) {
                    // alert("age is a required field");
                    // return false
                }; 
                    
            // relationship field - grab value and validate
                var rel = document.getElementsByName('rel')[0];
                var rel_val = rel.value
                if(rel_val.length < 3) {
                    // alert('relationship is a required field');
                    // return false
                };

            // smoker field - grab value and validate
                var smoker = document.getElementById('smoker');
                var smoke_check = smoker.checked;
                var smoke_val = smoker.value;

                if (smoke_check === true) {
                    smoke_val = "smoker";
                } else {
                    smoke_val = "non smoker";
                };

            // remove button    
                var removeBtn = document.createElement("BUTTON");
                removeBtn.className = "removeMe";
                removeBtn.innerHTML = 'Remove';
                removeBtn.setAttribute('onclick', 'removeMe(this);');
                removeBtn.style.cssText = 'margin-top:5px;padding:1px;background-color:#EAEAEA;border:1px solid transparent;';
            
            // person details  
                var person = "Age: " + age_val + ", " + "<br>" + " " + "Relationship: " + rel_val + ", " + "<br>" + " " + smoke_val + "<br>";
                document.getElementById('list').innerHTML = "<ul><li style='list-style-type:none;padding:5px 0;'>" + person + "</li></ul>";
                document.getElementsByTagName('li')[0].appendChild(removeBtn);

                e.preventDefault();
            };

            function removeMe(item) {
                var parent = item.parentElement;
                parent.parentElement.removeChild(parent);
            };

            document.getElementsByTagName('button')[1].addEventListener('click', serialize);

            function serialize(e) {
                console.log("what's up");
                e.preventDefault();
            }
            
        </script>
    </body>
</html>